<xml xmlns="https://developers.google.com/blockly/xml"><block type="pxt-on-start" id="^m`Veq+1*L0BO+g!X{4r" x="0" y="0"><statement name="HANDLER"><block type="typescript_statement" id="*8639bj6KZld[iaA0^f}" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="namespace threadtheneedle {" line1="    const NeedleTop = SpriteKind.create()" line2="    const Thread = SpriteKind.create()" line3="    const Needle = SpriteKind.create()" line4="" line5="    //% block=&quot;thread the needle with $color&quot;" line6="    //% color.shadow=colorindexpicker" line7="    //% color.defl=10" line8="    export function runGame(color: number) {" line9="        game.pushScene();" line10="        if (!color) {" line11="            color = 0xD;" line12="        }" line13="        scene.setBackgroundColor(color === 0xF ? 0xD : 0xF)" line14="" line15="        let isHittingNeedle = false" line16="        const needleHole = sprites.create(img`" line17="            . c . " line18="            c . c " line19="            c . c " line20="            c . c " line21="            . . . " line22="            . . . " line23="            . . . " line24="            . . . " line25="            . . . " line26="            . . . " line27="            . . . " line28="            . . . " line29="            . . . " line30="            . . . " line31="            . . . " line32="            . . . " line33="            . . . " line34="            . . . " line35="            . . . " line36="            . . . " line37="            . . . " line38="            . . . " line39="            . . . " line40="            . . . " line41="            . . . " line42="            . . . " line43="            . . . " line44="            . . . " line45="            . . . " line46="            . . . " line47="            . . . " line48="            . . . " line49="            . . . " line50="            . . . " line51="            . . . " line52="            . . . " line53="            . . . " line54="            . . . " line55="            . . . " line56="            . . . " line57="            . . . " line58="            . . . " line59="            . . . " line60="            . . . " line61="            . . . " line62="            . . . " line63="            . . . " line64="            . . . " line65="            . . . " line66="            . . . " line67="            . . . " line68="            . . . " line69="            . . . " line70="            . . . " line71="            . . . " line72="            . . . " line73="            . . . " line74="            . . . " line75="            `, NeedleTop)" line76="        const mainNeedle = sprites.create(img`" line77="            . . . " line78="            . . c " line79="            . . c " line80="            . . c " line81="            c c c " line82="            c c c " line83="            c c c " line84="            c c 9 " line85="            c c 9 " line86="            c c 9 " line87="            c c 9 " line88="            c c 9 " line89="            c c 9 " line90="            c c 9 " line91="            c c 9 " line92="            c c 9 " line93="            c c 9 " line94="            c c 9 " line95="            c c 9 " line96="            c c 9 " line97="            c c 9 " line98="            c c 9 " line99="            c c 9 " line100="            c c 9 " line101="            c c 9 " line102="            c c 9 " line103="            c c 9 " line104="            c c 9 " line105="            c c 9 " line106="            c c 9 " line107="            c c 9 " line108="            c c 9 " line109="            c c 9 " line110="            c c 9 " line111="            c c 9 " line112="            c c 9 " line113="            c c 9 " line114="            c c 9 " line115="            c c 9 " line116="            c c 9 " line117="            c c 9 " line118="            c 9 9 " line119="            c 9 9 " line120="            c 9 9 " line121="            c 9 9 " line122="            c 9 9 " line123="            c 9 9 " line124="            c 9 9 " line125="            c 9 9 " line126="            c 9 9 " line127="            c 9 9 " line128="            c 9 9 " line129="            c 9 9 " line130="            c 9 9 " line131="            c c 9 " line132="            . c . " line133="            . c . " line134="            . 1 . " line135="            `, Needle)" line136="        needleHole.setPosition(140, 60)" line137="        mainNeedle.setPosition(140, 60)" line138="        mainNeedle.z = 10" line139="        const hand = sprites.create(img`" line140="            ............................................aaaa" line141="            ...........................................aa..." line142="            ........................................aaaa...." line143="            ................................eee....aa......." line144="            .............................eeeedde.aaa........" line145="            ...........................eedddd3de.aeee......." line146="            ..........................eeddd3333eeaede......." line147="            .........................eedddd3333deaddee......" line148="            ........................eedddddddddeeedddee....." line149="            .......................eeddddddddeeeeddddee....." line150="            ......................eeddddddddeeeeddddde......" line151="            ....................eeeddddddddeeeedddddee......" line152="            ...................eedddddddddeeeddddddeee......" line153="            ..................eeddddddddeeeeddddddedde......" line154="            .................eeddddddddeeeddddddeeddde......" line155="            ...............eeeddddddddeeeedddddeedddee......" line156="            ...............eddddddddddeeddddddeedddee......." line157="            ..............eddddddddddddddddddeedddeeee......" line158="            ..............eddddddddddddddddeeddddeedde......" line159="            .............eedddddddddddddddeeddddedddde......" line160="            .............eddddddddddddddddddddeeddddde......" line161="            .............edddddddddddddddddddeedddeede......" line162="            .............edddddddddddddddddddeddddede......." line163="            ...........aaeddddddddddddddddddddddeedde......." line164="            ...........a.eddddddddddddddddddddddeddde......." line165="            .........aa..edddddddddddddddddddddedddee......." line166="            ........a....edddddddddddddddddddddddee........." line167="            .......a.....eeddddddddddddddddddddeee.........." line168="            ......a.......edddddddddddddddddddee............" line169="            .....aa.......eeddddddddddddddeeee.............." line170="            .....a.........edddddddddddddee................." line171="            ...aa..........eeddddddddeeeee.................." line172="            ..aa...........eeeeeeeeeee......................" line173="            `, SpriteKind.Player)" line174="        hand.setPosition(18, 77)" line175="        controller.moveSprite(hand, 300, 300)" line176="        const threadDisplay = sprites.create(img`" line177="            a a a a a a a a a a" line178="        `, Thread)" line179="        hand.image.replace(10, color);" line180="        threadDisplay.image.replace(10, color);" line181="        spriteutils.createRenderable(" line182="            -5," line183="            scr =&gt; scr.drawLine(0, 120, hand.left + 1, hand.bottom, color)" line184="        );" line185="        game.onUpdate(() =&gt; {" line186="            threadDisplay.top = hand.top" line187="            threadDisplay.left = hand.right" line188="            if (threadDisplay.overlapsWith(needleHole) || threadDisplay.overlapsWith(mainNeedle)) {" line189="                if (threadDisplay.overlapsWith(needleHole)) {" line190="                    if (!isHittingNeedle) {" line191="                        if (!isHittingNeedle &amp;&amp; hand.vx &gt; 0 &amp;&amp; threadDisplay.top &gt; needleHole.top + 1) {" line192="                            threadDisplay.z = 5" line193="                        } else {" line194="                            threadDisplay.z = 15" line195="                            hand.z = 15;" line196="                        }" line197="                    }" line198="                } else {" line199="                    threadDisplay.z = 15" line200="                    hand.z = 15;" line201="                }" line202="                isHittingNeedle = true" line203="            } else {" line204="                isHittingNeedle = false" line205="                threadDisplay.z = 15" line206="                hand.z = 15;" line207="            }" line208="        })" line209="        pauseUntil(() =&gt; " line210="            threadDisplay.overlapsWith(needleHole)" line211="            &amp;&amp; threadDisplay.z == 5" line212="            &amp;&amp; threadDisplay.right &gt;= mainNeedle.right + 2" line213="        );" line214="        controller.moveSprite(hand, 0, 0);" line215="        hand.startEffect(effects.hearts);" line216="        hand.z = 0;" line217="        pause(1500)" line218="        game.popScene();" line219="    }" line220="}" numlines="221"></mutation></block></statement></block></xml>